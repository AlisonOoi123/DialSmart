{% extends "base.html" %}

{% block title %}Find Your Perfect Phone - DialSmart{% endblock %}

{% block content %}
<div class="container py-5">
    <h2 class="text-center mb-4"><i class="bi bi-magic"></i> Find Your Perfect Phone</h2>
    <p class="text-center text-muted">Answer a few quick questions to get personalized recommendations</p>

    <div class="row justify-content-center">
        <div class="col-md-8">
            <form method="POST" id="wizardForm">
                <!-- Step 1: Budget -->
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5><i class="bi bi-1-circle"></i> What's your budget range?</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <label class="form-label">Minimum Budget (RM)</label>
                                <input type="number" name="min_budget" class="form-control" value="500" min="0">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Maximum Budget (RM)</label>
                                <input type="number" name="max_budget" class="form-control" value="5000" min="0">
                            </div>
                        </div>
                        <div class="mt-3">
                            <button type="button" class="btn btn-sm btn-outline-primary" onclick="setBudget(0, 1000)">Under RM1000</button>
                            <button type="button" class="btn btn-sm btn-outline-primary" onclick="setBudget(1000, 2000)">RM1000-2000</button>
                            <button type="button" class="btn btn-sm btn-outline-primary" onclick="setBudget(2000, 3000)">RM2000-3000</button>
                            <button type="button" class="btn btn-sm btn-outline-primary" onclick="setBudget(3000, 10000)">RM3000+</button>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Usage Priority -->
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5><i class="bi bi-2-circle"></i> What will you primarily use your phone for?</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="primary_usage" value="Photography" id="usage1">
                                    <label class="form-check-label" for="usage1">
                                        <i class="bi bi-camera"></i> Photography
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="primary_usage" value="Gaming" id="usage2">
                                    <label class="form-check-label" for="usage2">
                                        <i class="bi bi-controller"></i> Gaming
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="primary_usage" value="Work" id="usage3">
                                    <label class="form-check-label" for="usage3">
                                        <i class="bi bi-briefcase"></i> Work/Productivity
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="primary_usage" value="Social Media" id="usage4">
                                    <label class="form-check-label" for="usage4">
                                        <i class="bi bi-share"></i> Social Media
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="primary_usage" value="Entertainment" id="usage5">
                                    <label class="form-check-label" for="usage5">
                                        <i class="bi bi-play-circle"></i> Entertainment
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Important Features -->
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5><i class="bi bi-3-circle"></i> Which features matter most? (Select up to 3)</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="important_features" value="Battery" id="feat1">
                                    <label class="form-check-label" for="feat1">Long Battery Life</label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="important_features" value="Camera" id="feat2">
                                    <label class="form-check-label" for="feat2">Great Camera</label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="important_features" value="Performance" id="feat3">
                                    <label class="form-check-label" for="feat3">Fast Performance</label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="important_features" value="Storage" id="feat4">
                                    <label class="form-check-label" for="feat4">Large Storage</label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="important_features" value="5G" id="feat5">
                                    <label class="form-check-label" for="feat5">5G Connectivity</label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="important_features" value="Design" id="feat6">
                                    <label class="form-check-label" for="feat6">Premium Design</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Brand Preference -->
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5><i class="bi bi-4-circle"></i> Any brand preferences?</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            {% for brand in brands %}
                            <div class="col-md-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="preferred_brands" value="{{ brand.id }}" id="brand{{ brand.id }}">
                                    <label class="form-check-label" for="brand{{ brand.id }}">
                                        {{ brand.name }}
                                    </label>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                <div class="text-center">
                    <button type="submit" class="btn btn-primary btn-lg" onclick="return validateBudget()">
                        <i class="bi bi-search"></i> Get Recommendations
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
function setBudget(min, max) {
    document.querySelector('input[name="min_budget"]').value = min;
    document.querySelector('input[name="max_budget"]').value = max;
}

function validateBudget() {
    const minBudget = parseInt(document.querySelector('input[name="min_budget"]').value);
    const maxBudget = parseInt(document.querySelector('input[name="max_budget"]').value);

    if (minBudget > maxBudget) {
        alert('⚠️ Warning: Minimum budget (RM' + minBudget + ') cannot be greater than maximum budget (RM' + maxBudget + ').\n\nPlease adjust your budget range.');
        return false;
    }

    if (minBudget < 0 || maxBudget < 0) {
        alert('⚠️ Warning: Budget values cannot be negative.');
        return false;
    }

    return true;
}
</script>
{% endblock %}
